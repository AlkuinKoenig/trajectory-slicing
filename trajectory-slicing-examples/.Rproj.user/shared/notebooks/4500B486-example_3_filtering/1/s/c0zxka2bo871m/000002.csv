"0","angle_range = c(-160, -90)"
"0",""
"0",""
"0","selection_mask= sliced_df_1%>%"
"0","  dplyr::filter(angle_wmean_Nmid>=angle_range[1], angle_wmean_Nmid <= angle_range[2])%>%"
"0","  dplyr::group_by(slice_position, ID)%>%"
"0","  dplyr::summarise(crossed = any(crossing_type == ""decreasing""),.groups = ""drop"")%>%"
"0","  dplyr::group_by(ID)%>%"
"0","  dplyr::summarise(slices_crossed = sum(crossed>0,na.rm=TRUE))%>%"
"0","  dplyr::filter(slices_crossed == length(unique(sliced_df_1$slice_position)))#only take trajectories that crossed ALL the slices at the specified angles"
"0",""
"0",""
"0","myHYS_E3_filtered = myHYS_E3 %>%"
"0","    dplyr::filter(ID %in% selection_mask$ID)"
"0",""
"0","#create a new coordinate system to be plotted on the map"
"0","radial_coords_system_df = create_radial_guide_df(slice_radius = unique(sliced_df_1$slice_position),"
"0","                                         lon_center = unique(sliced_df_1$lon_i)%>%na.omit(),"
"0","                                         lat_center = unique(sliced_df_1$lat_i)%>%na.omit())"
"0",""
"0","ggplot(myHYS_E3, aes(x=lon, y = lat, group=ID))+"
"0","  geom_path(color = ""gray50"")+"
"0","  geom_path(data = myHYS_E3_filtered, aes(colour=height))+"
"0","  "
"0","  geom_path(data = world, aes(x=long, y=lat, group=group), color='black', size=0.7, inherit.aes=FALSE)+"
"0","  geom_path(data=radial_coords_system_df , aes(x=lon, y = lat, group = slice_position),inherit.aes=FALSE, col = ""blue"")+"
"0","  geom_path(data=radial_coords_system_df %>% dplyr::filter(angle_180 >= angle_range[1], angle_180 <= angle_range[2]),"
"0","            aes(x=lon, y = lat, group = slice_position),inherit.aes=FALSE, col = ""red"",size=1)+"
"0","  annotate(geom=""point"", x = myHYS_E3$lon_i[1], y = myHYS_E3$lat_i[1],colour=""red"")+"
"0","  scale_colour_viridis_c(limits = c(0,6000),oob= scales::squish)+"
"0","  coord_cartesian(ylim = c(-80,-10),xlim = c(-50,65))+ #note that I'm ""zooming in"""
"0","  labs(subtitle = ""Filter: Cross red segments. Unfiltered trajectories shown in grey"")"
"0",""
